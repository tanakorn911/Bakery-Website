{% extends "layout.html" %}
{% block title %}รายละเอียดคำสั่งซื้อ #{{ order.id }}{% endblock %}

{% block content %}
<div class="container py-5">
    <h4>คำสั่งซื้อ #{{ order.id }}</h4>
    <p>วันที่: {{ order.created_at }} | สถานะ: 
        <span class="badge bg-{{ 'success' if order.status=='completed' else 'warning' }}">{{ order.status }}</span>
    </p>

    <h5 class="mt-4">ข้อมูลผู้รับ</h5>
    <p>
        ชื่อ: {{ order.customer_name }}<br>
        เบอร์โทร: {{ order.customer_phone }}<br>
        ที่อยู่: {{ order.customer_address or 'ไม่ระบุ' }}<br>
        หมายเหตุ: {{ order.notes or '-' }}
    </p>

    <h5 class="mt-4">รายการสินค้า</h5>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>สินค้า</th>
                <th>ราคา/หน่วย</th>
                <th>จำนวน</th>
                <th>รวม</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
            <tr>
                <td>{{ item.name }}</td>
                <td>{{ "%.2f"|format(item.unit_price) }} บาท</td>
                <td>{{ item.quantity }}</td>
                <td>{{ "%.2f"|format(item.total_price) }} บาท</td>
                <td>
                    {% if order.status == 'pending' %}
                    <button class="btn btn-sm btn-outline-danger" onclick="cancelItem({{ item.id }})">ยกเลิก</button>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <th colspan="3" class="text-end">รวมทั้งหมด</th>
                <th>{{ "%.2f"|format(order.total_amount) }} บาท</th>
            </tr>
        </tfoot>
    </table>

    <a href="{{ url_for('order_history') }}" class="btn btn-secondary mt-3">กลับ</a>
</div>

<script src="{{ url_for('static', filename='js/main.js') }}"></script>

{% endblock %}

